<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>My treatment history</title>
    <!--    Icon    -->
    <link rel="shortcut icon" type="../image/x-icon" href="../pictures/iconbig.ico">
    <!--    Css     -->
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/individual_page.css">
    <!--    Bootstrap    -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!--    Google Fonts    -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
    <!--    Font awesome    -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
          integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
</head>
<body>

<div class="content" style="width: 100%">
    <div class="row" style="width: 100%;">
        <!--Vertical navigation-->
        <div class="col-md-2 admin-nav-page">
            <h5 style="text-align: center; margin: 30px; color: white"><b>Сторінка адміна</b></h5>
            <div style="margin-top: 20px">
                <button class="btn custom-menu-btn" type="button" id="dropdownDoc" style="width: 100%;" aria-expanded="false" onclick="location.href='admin_doctor_page.html';">
                    Дії з лікарем
                </button>
                <button class="btn custom-menu-btn" type="button" id="dropdownPat" style="width: 100%;" aria-expanded="false"onclick="location.href='admin_patient_page.html';">
                    Дії з пацієнтом
                </button>
                <button class="btn custom-menu-btn" type="button" id="dropdownMed" style="width: 100%;" aria-expanded="false" onclick="location.href='admin_medicine_page.html';">
                    Дії з ліками
                </button>
            </div>
        </div>
        <!--Vertical navigation-->
        <!--Main content-->
        <div class="col-md-10">
            <!--Navbar-->
            <nav class="navbar navbar-expand-lg">
                <a class="navbar-brand navbar-custom-text  my-2" href="index.html" ><img
                        src="../pictures/icon.png" alt=""></i>
                    Моя історія захворювань</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav md-auto" style="margin-left: 10%">
                        <li class="nav-item active">
                            <a class="nav-link navbar-custom-text" href="index.html">Головна сторінка <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link navbar-custom-text" href="news.html">Новини <span
                                    class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link navbar-custom-text" href="contact_us.html">Зв'язатись з нами <span
                                    class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle navbar-custom-text" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Переглянути історію лікування
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" style="text-align: left" href="cabinet.html"><i class="fas fa-book-medical"></i> Архів</a>
                                <a class="dropdown-item" style="text-align: left" href="patient_page.html"><i class="fas fa-user"></i> Особистий кабінет</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" style="text-align: left" href="admin_page.html"><i class="fas fa-user-shield"></i> Сторінка адміна</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link navbar-custom-text" href="sign_in.html">Увійти</a>
                        </li>
                    </ul>
                </div>
            </nav>
            <!--Navbar-->
            <!--Main inner content-->
            <div style="background-color: #f6f7fa; width: 100%">
                <div class="row" style="padding-top: 40px; padding-bottom: 40px;">
                    <div class= " offset-md-1 col-md-10">
                        <div class="card custom-card">
                            <div class="card-body">
                                <h5 class="card-title" style="text-align: center">Додати нові ліки</h5>
                                <form id="addNewMedicineForm">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" style="text-align: right">
                                                <label>Назва: </label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" id="medicineName" placeholder="Валідол">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" style="text-align: right">
                                                <label>ID групи аналогів: </label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" id="medicineAnalogId" placeholder="0">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" style="text-align: right">
                                                <label>Ціна: </label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" id="medicinePrice" placeholder="2000">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" style="text-align: right">
                                                <label>Опис: </label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" id="medicineDescription" placeholder="Опис діючих речовин, дози, країни походження ітд...">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-2 offset-md-5">
                                            <button type="submit" class="btn btn-primary btn-block" >Додати</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--                        Delete-->
                        <div class="card custom-card" style="margin-top: 30px">
                            <div class="card-body">
                                <h5 class="card-title" style="text-align: center">Видалити ліки за ID</h5>
                                <form id="deleteMedicineForm">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-md-2" style="text-align: right">
                                                <label>ID ліків: </label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" class="form-control" id="medInputDeleteId">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-2 offset-md-5">
                                            <button type="submit" class="btn btn-danger btn-block">Видалити</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--Main inner content-->
            <!--Footer-->
            <footer class="bd-footer text-muted">
                <div class="container-fluid p-3 p-md-5 d-flex justify-content-center" id="footer-id">
                    <p>Сайт створив студент групи КН-305 Шимоняк Андрій</p>
                </div>
            </footer>
            <!--Footer-->
        </div>
        <!--Main content-->
    </div>
</div>
</body>


<!--    jQuery  -->
<script src="../js/jquery.min.js"></script>
<!--    Popper.js   -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<!--    Bootstrap JS    -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<!--Custom-->
<script src="../js/globalValues.js"></script>
<script>
    $(document).ready(function () {

        $('#addNewMedicineForm').submit(function(e){
            e.preventDefault();
            addNewMedicine();
        });

        $('#deleteMedicineForm').submit(function(e) {
            e.preventDefault();
            deleteMedicineById();
        })

        function addNewMedicine(){
            let analogId = $('#medicineAnalogId').val();
            let price = $('#medicinePrice').val();
            let name = $('#medicineName').val();
            let description = $('#medicineDescription').val();

            let medicine = {
                analogId: analogId,
                price: price,
                name: name,
                description: description
            };
            console.log(medicine);

            $.ajax({
                url: serverUrl + 'medicine',
                method: 'POST',
                dataType: 'json',
                contentType: 'application/json',
                data: JSON.stringify(medicine),
                complete: function (data) {
                    console.log(data);
                    if (data.status == 500) {
                        console.log('Error happened');
                    }
                    if (data.status == 201) {
                        $('#addNewMedicineForm')[0].reset();
                        alert("Ліки додано!");
                    }
                }
            })
        }

        function deleteMedicineById(){
            let medicineId = $('#medInputDeleteId').val();
            console.log(medicineId);
            console.log(serverUrl + 'medicine/delete/' + medicineId);
            $.ajax({
                url: serverUrl + 'medicine/delete/' + medicineId,
                type: 'DELETE',
                success: function(data){
                    $('#deleteMedicineForm')[0].reset();
                    console.log("OK");
                    alert("Ліки з ID=" + medicineId + ' видалено');
                }, error: function(data){
                    console.log("Error: " + data);
                }
            })
        }

    })
</script>

</html>